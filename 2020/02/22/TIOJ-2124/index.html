<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>TIOJ-2124 | 蛋餅的競程隨筆</title><link rel=canonical href=https://omeletwithoutegg.github.io/2020/02/22/TIOJ-2124/><meta name=description content="一個廢人想寫題解，所以他想辦法弄網站"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="TIOJ-2124"><meta property="og:description" content="殿壬看蝴蝶 https://tioj.ck.tp.edu.tw/problems/2124
Description 太長了，略
Solution 看到第五種操作就會想用平衡樹去寫這題
然後仔細看看就會發現第八種操作其實和其他操作都沒什麼關係，只有第三、四種操作會改變以蝴蝶編號為順序的區間和
所以呢對蝴蝶的編號開一個線段樹、對樹的編號開個Splay就能AC了
Splay只需要實現查一個節點在中序是第個、查中序第k個節點是什麼，還有剪切區間
至於區間和就隨便維護吧XD，code如下，我不知道該對裸題做甚麼解釋
寫剪切區間的splay的時候要注意的可能就是不要改到空節點(我是用0代表空節點)的任何值
也小心不要讓合併的時候合併到同一棵splay，出現環
中途有一次一個回傳int的函數忘記回傳東西，在TIOJ上吃SF
AC code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215  #include <cstdio>#include <cstdlib> const int N = 200025; int n, q, v[N]; struct SplayTree { struct node { int val, sz; int sum; int ch[2], pa; //bool rev;  } S[N]; bool dir(int i) {return i==S[S[i]."><meta property="og:type" content="article"><meta property="og:url" content="https://omeletwithoutegg.github.io/2020/02/22/TIOJ-2124/"><meta property="article:published_time" content="2020-02-22T20:04:25+00:00"><meta property="article:modified_time" content="2020-02-22T20:04:25+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="TIOJ-2124"><meta name=twitter:description content="殿壬看蝴蝶 https://tioj.ck.tp.edu.tw/problems/2124
Description 太長了，略
Solution 看到第五種操作就會想用平衡樹去寫這題
然後仔細看看就會發現第八種操作其實和其他操作都沒什麼關係，只有第三、四種操作會改變以蝴蝶編號為順序的區間和
所以呢對蝴蝶的編號開一個線段樹、對樹的編號開個Splay就能AC了
Splay只需要實現查一個節點在中序是第個、查中序第k個節點是什麼，還有剪切區間
至於區間和就隨便維護吧XD，code如下，我不知道該對裸題做甚麼解釋
寫剪切區間的splay的時候要注意的可能就是不要改到空節點(我是用0代表空節點)的任何值
也小心不要讓合併的時候合併到同一棵splay，出現環
中途有一次一個回傳int的函數忘記回傳東西，在TIOJ上吃SF
AC code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215  #include <cstdio>#include <cstdlib> const int N = 200025; int n, q, v[N]; struct SplayTree { struct node { int val, sz; int sum; int ch[2], pa; //bool rev;  } S[N]; bool dir(int i) {return i==S[S[i]."><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/styles.36c12a99052778131d28078b3171237fd0184ad9b87c778208912a8d08e2d0194867a030c64d9b02d6077de53a8a9979249331f971fb47c471a2d59676520a3a.css integrity="sha512-NsEqmQUneBMdKAeLMXEjf9AYStm4fHeCCJEqjQji0BlIZ6Awxk2bAtYHfeU6ipl5JJMx+XH7R8RxotWWdlIKOg=="><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/highlight.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/style-dark.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/search.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://omeletwithoutegg.github.io/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-153846761-1','auto');ga('send','pageview');}</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-153846761-1"></script><script>var doNotTrack=false;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-153846761-1',{'anonymize_ip':false});}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/resources>Resources</a></li><li><a href=/search>Search</a></li><li><a href=/tags>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://omeletwithoutegg.github.io/2020/02/20/TIOJ-1884/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://omeletwithoutegg.github.io/2020/02/23/TIOJ-1129/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');" aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&text=TIOJ-2124" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&is_video=false&description=TIOJ-2124" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TIOJ-2124&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&name=TIOJ-2124&description=%e6%ae%bf%e5%a3%ac%e7%9c%8b%e8%9d%b4%e8%9d%b6%20https%3a%2f%2ftioj.ck.tp.edu.tw%2fproblems%2f2124%0aDescription%20%e5%a4%aa%e9%95%b7%e4%ba%86%ef%bc%8c%e7%95%a5%0aSolution%20%e7%9c%8b%e5%88%b0%e7%ac%ac%e4%ba%94%e7%a8%ae%e6%93%8d%e4%bd%9c%e5%b0%b1%e6%9c%83%e6%83%b3%e7%94%a8%e5%b9%b3%e8%a1%a1%e6%a8%b9%e5%8e%bb%e5%af%ab%e9%80%99%e9%a1%8c%0a%e7%84%b6%e5%be%8c%e4%bb%94%e7%b4%b0%e7%9c%8b%e7%9c%8b%e5%b0%b1%e6%9c%83%e7%99%bc%e7%8f%be%e7%ac%ac%e5%85%ab%e7%a8%ae%e6%93%8d%e4%bd%9c%e5%85%b6%e5%af%a6%e5%92%8c%e5%85%b6%e4%bb%96%e6%93%8d%e4%bd%9c%e9%83%bd%e6%b2%92%e4%bb%80%e9%ba%bc%e9%97%9c%e4%bf%82%ef%bc%8c%e5%8f%aa%e6%9c%89%e7%ac%ac%e4%b8%89%e3%80%81%e5%9b%9b%e7%a8%ae%e6%93%8d%e4%bd%9c%e6%9c%83%e6%94%b9%e8%ae%8a%e4%bb%a5%e8%9d%b4%e8%9d%b6%e7%b7%a8%e8%99%9f%e7%82%ba%e9%a0%86%e5%ba%8f%e7%9a%84%e5%8d%80%e9%96%93%e5%92%8c%0a%e6%89%80%e4%bb%a5%e5%91%a2%e5%b0%8d%e8%9d%b4%e8%9d%b6%e7%9a%84%e7%b7%a8%e8%99%9f%e9%96%8b%e4%b8%80%e5%80%8b%e7%b7%9a%e6%ae%b5%e6%a8%b9%e3%80%81%e5%b0%8d%e6%a8%b9%e7%9a%84%e7%b7%a8%e8%99%9f%e9%96%8b%e5%80%8bSplay%e5%b0%b1%e8%83%bdAC%e4%ba%86%0aSplay%e5%8f%aa%e9%9c%80%e8%a6%81%e5%af%a6%e7%8f%be%e6%9f%a5%e4%b8%80%e5%80%8b%e7%af%80%e9%bb%9e%e5%9c%a8%e4%b8%ad%e5%ba%8f%e6%98%af%e7%ac%ac%e5%80%8b%e3%80%81%e6%9f%a5%e4%b8%ad%e5%ba%8f%e7%ac%ack%e5%80%8b%e7%af%80%e9%bb%9e%e6%98%af%e4%bb%80%e9%ba%bc%ef%bc%8c%e9%82%84%e6%9c%89%e5%89%aa%e5%88%87%e5%8d%80%e9%96%93%0a%e8%87%b3%e6%96%bc%e5%8d%80%e9%96%93%e5%92%8c%e5%b0%b1%e9%9a%a8%e4%be%bf%e7%b6%ad%e8%ad%b7%e5%90%a7XD%ef%bc%8ccode%e5%a6%82%e4%b8%8b%ef%bc%8c%e6%88%91%e4%b8%8d%e7%9f%a5%e9%81%93%e8%a9%b2%e5%b0%8d%e8%a3%b8%e9%a1%8c%e5%81%9a%e7%94%9a%e9%ba%bc%e8%a7%a3%e9%87%8b%0a%e5%af%ab%e5%89%aa%e5%88%87%e5%8d%80%e9%96%93%e7%9a%84splay%e7%9a%84%e6%99%82%e5%80%99%e8%a6%81%e6%b3%a8%e6%84%8f%e7%9a%84%e5%8f%af%e8%83%bd%e5%b0%b1%e6%98%af%e4%b8%8d%e8%a6%81%e6%94%b9%e5%88%b0%e7%a9%ba%e7%af%80%e9%bb%9e%28%e6%88%91%e6%98%af%e7%94%a80%e4%bb%a3%e8%a1%a8%e7%a9%ba%e7%af%80%e9%bb%9e%29%e7%9a%84%e4%bb%bb%e4%bd%95%e5%80%bc%0a%e4%b9%9f%e5%b0%8f%e5%bf%83%e4%b8%8d%e8%a6%81%e8%ae%93%e5%90%88%e4%bd%b5%e7%9a%84%e6%99%82%e5%80%99%e5%90%88%e4%bd%b5%e5%88%b0%e5%90%8c%e4%b8%80%e6%a3%b5splay%ef%bc%8c%e5%87%ba%e7%8f%be%e7%92%b0%0a%e4%b8%ad%e9%80%94%e6%9c%89%e4%b8%80%e6%ac%a1%e4%b8%80%e5%80%8b%e5%9b%9e%e5%82%b3int%e7%9a%84%e5%87%bd%e6%95%b8%e5%bf%98%e8%a8%98%e5%9b%9e%e5%82%b3%e6%9d%b1%e8%a5%bf%ef%bc%8c%e5%9c%a8TIOJ%e4%b8%8a%e5%90%83SF%0aAC%20code%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%2014%2015%2016%2017%2018%2019%2020%2021%2022%2023%2024%2025%2026%2027%2028%2029%2030%2031%2032%2033%2034%2035%2036%2037%2038%2039%2040%2041%2042%2043%2044%2045%2046%2047%2048%2049%2050%2051%2052%2053%2054%2055%2056%2057%2058%2059%2060%2061%2062%2063%2064%2065%2066%2067%2068%2069%2070%2071%2072%2073%2074%2075%2076%2077%2078%2079%2080%2081%2082%2083%2084%2085%2086%2087%2088%2089%2090%2091%2092%2093%2094%2095%2096%2097%2098%2099%20100%20101%20102%20103%20104%20105%20106%20107%20108%20109%20110%20111%20112%20113%20114%20115%20116%20117%20118%20119%20120%20121%20122%20123%20124%20125%20126%20127%20128%20129%20130%20131%20132%20133%20134%20135%20136%20137%20138%20139%20140%20141%20142%20143%20144%20145%20146%20147%20148%20149%20150%20151%20152%20153%20154%20155%20156%20157%20158%20159%20160%20161%20162%20163%20164%20165%20166%20167%20168%20169%20170%20171%20172%20173%20174%20175%20176%20177%20178%20179%20180%20181%20182%20183%20184%20185%20186%20187%20188%20189%20190%20191%20192%20193%20194%20195%20196%20197%20198%20199%20200%20201%20202%20203%20204%20205%20206%20207%20208%20209%20210%20211%20212%20213%20214%20215%20%20%23include%20%26lt%3bcstdio%26gt%3b%23include%20%26lt%3bcstdlib%26gt%3b%20const%20int%20N%20%3d%20200025%3b%20int%20n%2c%20q%2c%20v%5bN%5d%3b%20struct%20SplayTree%20%7b%20struct%20node%20%7b%20int%20val%2c%20sz%3b%20int%20sum%3b%20int%20ch%5b2%5d%2c%20pa%3b%20%2f%2fbool%20rev%3b%20%20%7d%20S%5bN%5d%3b%20bool%20dir%28int%20i%29%20%7breturn%20i%3d%3dS%5bS%5bi%5d." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&t=TIOJ-2124" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#solution>Solution</a></li><li><a href=#ac-code>AC code</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">TIOJ-2124</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>2qbingxuan</span></span><div class=postdate><time datetime="2020-02-22 20:04:25 +0000 UTC" itemprop=datePublished>2020-02-22</time></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/TIOJ rel=tag>TIOJ</a>
,
<a class=tag-link href=/tags/data-structure rel=tag>data-structure</a>
,
<a class=tag-link href=/tags/splay-tree rel=tag>splay-tree</a></div></div></header><div class=content itemprop=articleBody><h1 id=殿壬看蝴蝶>殿壬看蝴蝶</h1><p><a href=https://tioj.ck.tp.edu.tw/problems/2124>https://tioj.ck.tp.edu.tw/problems/2124</a></p><h2 id=description>Description</h2><p>太長了，略</p><h2 id=solution>Solution</h2><p>看到第五種操作就會想用平衡樹去寫這題<br>然後仔細看看就會發現第八種操作其實和其他操作都沒什麼關係，只有第三、四種操作會改變以蝴蝶編號為順序的區間和<br>所以呢對蝴蝶的編號開一個線段樹、對樹的編號開個Splay就能AC了<br>Splay只需要實現查一個節點在中序是第個、查中序第k個節點是什麼，還有剪切區間<br>至於區間和就隨便維護吧XD，code如下，我不知道該對裸題做甚麼解釋</p><p>寫剪切區間的splay的時候要注意的可能就是不要改到空節點(我是用0代表空節點)的任何值<br>也小心不要讓合併的時候合併到同一棵splay，出現環<br>中途有一次一個回傳<code>int</code>的函數忘記回傳東西，在TIOJ上吃SF</p><h2 id=ac-code>AC code</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-cpp data-lang=cpp><span class=cp>#include</span> <span class=cpf>&lt;cstdio&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;cstdlib&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=k>const</span> <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=mi>200025</span><span class=p>;</span>
<span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>v</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
<span class=k>struct</span> <span class=nc>SplayTree</span> <span class=p>{</span>
    <span class=k>struct</span> <span class=nc>node</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>val</span><span class=p>,</span> <span class=n>sz</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>ch</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>pa</span><span class=p>;</span>
        <span class=c1>//bool rev;
</span><span class=c1></span>    <span class=p>}</span> <span class=n>S</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
    <span class=kt>bool</span> <span class=nf>dir</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span><span class=k>return</span> <span class=n>i</span><span class=o>==</span><span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>pa</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>];}</span>
    <span class=cm>/*void filp(int i) {
</span><span class=cm>        int t = S[i].ch[0]; S[i].ch[0]=S[i].ch[1]; S[i].ch[1]=t;
</span><span class=cm>        if(i) S[i].rev = !S[i].rev;
</span><span class=cm>    }
</span><span class=cm>    void push(int i) {
</span><span class=cm>        if(S[i].rev) {
</span><span class=cm>            flip(S[i].ch[0]);
</span><span class=cm>            flip(S[i].ch[1]);
</span><span class=cm>            S[i].rev = false;
</span><span class=cm>        }
</span><span class=cm>    }
</span><span class=cm>    void pushdown(int i) {
</span><span class=cm>        if(S[i].pa) pushdown(S[i].pa);
</span><span class=cm>        push(i);
</span><span class=cm>    }*/</span>
    <span class=kt>void</span> <span class=nf>pull</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>sum</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>]].</span><span class=n>sum</span> <span class=o>+</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>val</span> <span class=o>+</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>]].</span><span class=n>sum</span><span class=p>;</span>
        <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>sz</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>]].</span><span class=n>sz</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>]].</span><span class=n>sz</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>rot</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>pa</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>y</span><span class=p>].</span><span class=n>pa</span><span class=p>,</span> <span class=n>d</span> <span class=o>=</span> <span class=n>dir</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=n>S</span><span class=p>[</span><span class=n>z</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>dir</span><span class=p>(</span><span class=n>y</span><span class=p>)]</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>z</span><span class=p>;</span>
        <span class=n>S</span><span class=p>[</span><span class=n>y</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=o>!</span><span class=n>d</span><span class=p>];</span>
        <span class=k>if</span><span class=p>(</span><span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=o>!</span><span class=n>d</span><span class=p>])</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=o>!</span><span class=n>d</span><span class=p>]].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=o>!</span><span class=n>d</span><span class=p>]</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=n>S</span><span class=p>[</span><span class=n>y</span><span class=p>].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=n>pull</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=n>pull</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>splay</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>while</span><span class=p>(</span><span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>x</span><span class=p>].</span><span class=n>pa</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span><span class=p>(</span><span class=n>S</span><span class=p>[</span><span class=n>y</span><span class=p>].</span><span class=n>pa</span><span class=p>)</span> <span class=n>rot</span><span class=p>(</span><span class=n>dir</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>!=</span><span class=n>dir</span><span class=p>(</span><span class=n>y</span><span class=p>)</span> <span class=o>?</span> <span class=nl>x</span> <span class=p>:</span> <span class=n>y</span><span class=p>);</span>
            <span class=n>rot</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>kth</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>splay</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
        <span class=c1>//printf(&#34;k = %d\n&#34;, k);
</span><span class=c1></span>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=p>;</span> <span class=p>)</span> <span class=p>{</span>
            <span class=c1>//printf(&#34;i = %d\n&#34;, i);
</span><span class=c1></span>            <span class=c1>//system(&#34;PAUSE&#34;);
</span><span class=c1></span>            <span class=kt>int</span> <span class=n>s</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>]].</span><span class=n>sz</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
            <span class=c1>//printf(&#34;%d\n&#34;, s);
</span><span class=c1></span>            <span class=k>if</span><span class=p>(</span><span class=n>s</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span> <span class=k>return</span> <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=n>i</span><span class=p>;</span>
            <span class=k>if</span><span class=p>(</span><span class=n>k</span> <span class=o>&lt;</span> <span class=n>s</span><span class=p>)</span> <span class=n>i</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
            <span class=k>else</span> <span class=n>i</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>k</span> <span class=o>-=</span> <span class=n>s</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;No such node&#34;</span><span class=p>),</span> <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>getrank</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>S</span><span class=p>[</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>]].</span><span class=n>sz</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>endpoint</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>bool</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>for</span><span class=p>(</span><span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>d</span><span class=p>];</span> <span class=n>i</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>d</span><span class=p>]);</span>
        <span class=k>return</span> <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=n>i</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>split</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>bool</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>d</span><span class=p>];</span>
        <span class=n>S</span><span class=p>[</span><span class=n>res</span><span class=p>].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>pull</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>endpoint</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=o>!</span><span class=n>d</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>join</span><span class=p>(</span><span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>b</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>splay</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>splay</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>a</span> <span class=o>||</span> <span class=o>!</span><span class=n>b</span> <span class=o>||</span> <span class=n>S</span><span class=p>[</span><span class=n>a</span><span class=p>].</span><span class=n>pa</span> <span class=o>||</span> <span class=n>a</span> <span class=o>==</span> <span class=n>b</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
        <span class=c1>//printf(&#34;a = %d b = %d\n&#34;, a, b);
</span><span class=c1></span>        <span class=n>S</span><span class=p>[</span><span class=n>b</span><span class=p>].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>S</span><span class=p>[</span><span class=n>a</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>b</span><span class=p>,</span> <span class=n>pull</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>getsum</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [l, r]
</span><span class=c1></span>        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>b</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>r</span><span class=p>].</span><span class=n>sum</span><span class=p>;</span>
        <span class=n>join</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>l</span><span class=p>),</span> <span class=n>join</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>b</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=c1>//#define debug(x) printf(#x &#34; = %d\n&#34;, x);
</span><span class=c1></span>    <span class=kt>void</span> <span class=nf>jizz</span><span class=p>(</span><span class=kt>int</span> <span class=n>l1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>l2</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r2</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>//printf(&#34;IN\n&#34;);
</span><span class=c1></span>        <span class=c1>//debug(l1); debug(r1);
</span><span class=c1></span>        <span class=kt>int</span> <span class=n>a1</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>l1</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>r1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>a2</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>l2</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>b2</span> <span class=o>=</span> <span class=n>split</span><span class=p>(</span><span class=n>r2</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
        <span class=c1>//dbg(a1); dbg(b1); dbg(a2); dbg(b2);
</span><span class=c1></span>        <span class=n>join</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>l2</span><span class=p>),</span> <span class=n>join</span><span class=p>(</span><span class=n>r2</span><span class=p>,</span> <span class=n>b1</span><span class=p>);</span>
        <span class=n>join</span><span class=p>(</span><span class=n>a2</span><span class=p>,</span> <span class=n>l1</span><span class=p>),</span> <span class=n>join</span><span class=p>(</span><span class=n>r1</span><span class=p>,</span> <span class=n>b2</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>b1</span> <span class=o>==</span> <span class=n>l2</span><span class=p>)</span> <span class=n>join</span><span class=p>(</span><span class=n>r2</span><span class=p>,</span> <span class=n>l1</span><span class=p>);</span>
        <span class=c1>//if(b2 == l1) join(r1, l2);
</span><span class=c1></span>        <span class=c1>//dbg();
</span><span class=c1></span>        <span class=c1>//printf(&#34;OUT\n&#34;);
</span><span class=c1></span>    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>modify</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>val</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
        <span class=n>pull</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>v</span><span class=p>[])</span> <span class=p>{</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>sz</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>val</span> <span class=o>=</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>sum</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
            <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>].</span><span class=n>pa</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
            <span class=n>pull</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=cm>/*
</span><span class=cm>        std::function&lt;int(int,int)&gt; build = [&amp;](int l, int r) {
</span><span class=cm>            if(l &gt; r) return 0;
</span><span class=cm>            if(l == r) return l;
</span><span class=cm>            int m = (l+r)/2;
</span><span class=cm>            int L = build(l, m-1), R = build(m+1, r);
</span><span class=cm>            S[m].ch[0] = L, S[m].ch[1] = R, S[L].pa = S[R].pa = m, pull(m);
</span><span class=cm>            return m;
</span><span class=cm>        };
</span><span class=cm>        build(1, n);
</span><span class=cm>        */</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>dfs</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>i</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
        <span class=n>dfs</span><span class=p>(</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d &#34;</span><span class=p>,</span> <span class=n>i</span><span class=p>);</span>
        <span class=n>dfs</span><span class=p>(</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>ch</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>dbg</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;SPLAY %d: &#34;</span><span class=p>,</span> <span class=n>i</span><span class=p>);</span>
        <span class=n>splay</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=n>dfs</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span> <span class=n>sp</span><span class=p>;</span>
<span class=k>struct</span> <span class=nc>segtree</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>sum</span><span class=p>[</span><span class=n>N</span><span class=o>&lt;&lt;</span><span class=mi>1</span><span class=p>];</span>
    <span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>_n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>v</span><span class=p>[])</span> <span class=p>{</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>_n</span><span class=p>;</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=o>&lt;&lt;</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=o>&lt;&lt;</span><span class=mi>1</span><span class=o>|</span><span class=mi>1</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>modify</span><span class=p>(</span><span class=kt>int</span> <span class=n>p</span><span class=p>,</span> <span class=kt>int</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>for</span><span class=p>(</span><span class=n>sum</span><span class=p>[</span><span class=n>p</span><span class=o>+=</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span> <span class=n>p</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>;</span> <span class=n>p</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span>
            <span class=n>sum</span><span class=p>[</span><span class=n>p</span><span class=o>&gt;&gt;</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum</span><span class=p>[</span><span class=n>p</span><span class=p>]</span><span class=o>+</span><span class=n>sum</span><span class=p>[</span><span class=n>p</span><span class=o>^</span><span class=mi>1</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=nf>query</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [l, r) 0 base
</span><span class=c1></span>        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span><span class=p>(</span><span class=n>l</span><span class=o>+=</span><span class=n>n</span><span class=p>,</span> <span class=n>r</span><span class=o>+=</span><span class=n>n</span><span class=p>;</span> <span class=n>l</span><span class=o>&lt;</span><span class=n>r</span><span class=p>;</span> <span class=n>l</span><span class=o>&gt;&gt;=</span><span class=mi>1</span><span class=p>,</span> <span class=n>r</span><span class=o>&gt;&gt;=</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span><span class=p>(</span><span class=n>l</span><span class=o>&amp;</span><span class=mi>1</span><span class=p>)</span> <span class=n>res</span> <span class=o>+=</span> <span class=n>sum</span><span class=p>[</span><span class=n>l</span><span class=o>++</span><span class=p>];</span>
            <span class=k>if</span><span class=p>(</span><span class=n>r</span><span class=o>&amp;</span><span class=mi>1</span><span class=p>)</span> <span class=n>res</span> <span class=o>+=</span> <span class=n>sum</span><span class=p>[</span><span class=o>--</span><span class=n>r</span><span class=p>];</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span> <span class=n>sgt</span><span class=p>;</span>
<span class=kt>signed</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>q</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=n>v</span><span class=o>+</span><span class=n>i</span><span class=p>);</span>
    <span class=n>sp</span><span class=p>.</span><span class=n>init</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>v</span><span class=p>);</span>
    <span class=n>sgt</span><span class=p>.</span><span class=n>init</span><span class=p>(</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>v</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=n>q</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>t</span><span class=p>;</span>
        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>t</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>j</span><span class=p>);</span>
            <span class=n>sp</span><span class=p>.</span><span class=n>jizz</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>,</span><span class=n>j</span><span class=p>);</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>j</span><span class=p>);</span>
            <span class=n>i</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=n>j</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
            <span class=n>sp</span><span class=p>.</span><span class=n>jizz</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>,</span><span class=n>j</span><span class=p>);</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>d</span><span class=p>);</span>
            <span class=n>sp</span><span class=p>.</span><span class=n>modify</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
            <span class=n>sgt</span><span class=p>.</span><span class=n>modify</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>4</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>d</span><span class=p>);</span>
            <span class=n>i</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
            <span class=n>sp</span><span class=p>.</span><span class=n>modify</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
            <span class=n>sgt</span><span class=p>.</span><span class=n>modify</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>5</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>l1</span><span class=p>,</span> <span class=n>r1</span><span class=p>,</span> <span class=n>l2</span><span class=p>,</span> <span class=n>r2</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>l1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>r1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>l2</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>r2</span><span class=p>);</span>
            <span class=n>l1</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>l1</span><span class=p>),</span> <span class=n>r1</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>r1</span><span class=p>),</span> <span class=n>l2</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>l2</span><span class=p>),</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>r2</span><span class=p>);</span>
            <span class=n>sp</span><span class=p>.</span><span class=n>jizz</span><span class=p>(</span><span class=n>l1</span><span class=p>,</span> <span class=n>r1</span><span class=p>,</span> <span class=n>l2</span><span class=p>,</span> <span class=n>r2</span><span class=p>);</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>6</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>);</span>
            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>7</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>i</span><span class=p>);</span>
            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>sp</span><span class=p>.</span><span class=n>getrank</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>8</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>l</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>);</span>
            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>sgt</span><span class=p>.</span><span class=n>query</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=o>+</span><span class=mi>1</span><span class=p>));</span>
        <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>t</span> <span class=o>==</span> <span class=mi>9</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=p>;</span>
            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>l</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>);</span>
            <span class=n>l</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>l</span><span class=p>),</span> <span class=n>r</span> <span class=o>=</span> <span class=n>sp</span><span class=p>.</span><span class=n>kth</span><span class=p>(</span><span class=n>r</span><span class=p>);</span>
            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>sp</span><span class=p>.</span><span class=n>getsum</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=p>));</span>
        <span class=p>}</span>
        <span class=c1>//sp.dbg();
</span><span class=c1></span>    <span class=p>}</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='omeletwithoutegg';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/resources>Resources</a></li><li><a href=/search>Search</a></li><li><a href=/tags>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#solution>Solution</a></li><li><a href=#ac-code>AC code</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&text=TIOJ-2124" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&is_video=false&description=TIOJ-2124" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TIOJ-2124&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&title=TIOJ-2124" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&name=TIOJ-2124&description=%e6%ae%bf%e5%a3%ac%e7%9c%8b%e8%9d%b4%e8%9d%b6%20https%3a%2f%2ftioj.ck.tp.edu.tw%2fproblems%2f2124%0aDescription%20%e5%a4%aa%e9%95%b7%e4%ba%86%ef%bc%8c%e7%95%a5%0aSolution%20%e7%9c%8b%e5%88%b0%e7%ac%ac%e4%ba%94%e7%a8%ae%e6%93%8d%e4%bd%9c%e5%b0%b1%e6%9c%83%e6%83%b3%e7%94%a8%e5%b9%b3%e8%a1%a1%e6%a8%b9%e5%8e%bb%e5%af%ab%e9%80%99%e9%a1%8c%0a%e7%84%b6%e5%be%8c%e4%bb%94%e7%b4%b0%e7%9c%8b%e7%9c%8b%e5%b0%b1%e6%9c%83%e7%99%bc%e7%8f%be%e7%ac%ac%e5%85%ab%e7%a8%ae%e6%93%8d%e4%bd%9c%e5%85%b6%e5%af%a6%e5%92%8c%e5%85%b6%e4%bb%96%e6%93%8d%e4%bd%9c%e9%83%bd%e6%b2%92%e4%bb%80%e9%ba%bc%e9%97%9c%e4%bf%82%ef%bc%8c%e5%8f%aa%e6%9c%89%e7%ac%ac%e4%b8%89%e3%80%81%e5%9b%9b%e7%a8%ae%e6%93%8d%e4%bd%9c%e6%9c%83%e6%94%b9%e8%ae%8a%e4%bb%a5%e8%9d%b4%e8%9d%b6%e7%b7%a8%e8%99%9f%e7%82%ba%e9%a0%86%e5%ba%8f%e7%9a%84%e5%8d%80%e9%96%93%e5%92%8c%0a%e6%89%80%e4%bb%a5%e5%91%a2%e5%b0%8d%e8%9d%b4%e8%9d%b6%e7%9a%84%e7%b7%a8%e8%99%9f%e9%96%8b%e4%b8%80%e5%80%8b%e7%b7%9a%e6%ae%b5%e6%a8%b9%e3%80%81%e5%b0%8d%e6%a8%b9%e7%9a%84%e7%b7%a8%e8%99%9f%e9%96%8b%e5%80%8bSplay%e5%b0%b1%e8%83%bdAC%e4%ba%86%0aSplay%e5%8f%aa%e9%9c%80%e8%a6%81%e5%af%a6%e7%8f%be%e6%9f%a5%e4%b8%80%e5%80%8b%e7%af%80%e9%bb%9e%e5%9c%a8%e4%b8%ad%e5%ba%8f%e6%98%af%e7%ac%ac%e5%80%8b%e3%80%81%e6%9f%a5%e4%b8%ad%e5%ba%8f%e7%ac%ack%e5%80%8b%e7%af%80%e9%bb%9e%e6%98%af%e4%bb%80%e9%ba%bc%ef%bc%8c%e9%82%84%e6%9c%89%e5%89%aa%e5%88%87%e5%8d%80%e9%96%93%0a%e8%87%b3%e6%96%bc%e5%8d%80%e9%96%93%e5%92%8c%e5%b0%b1%e9%9a%a8%e4%be%bf%e7%b6%ad%e8%ad%b7%e5%90%a7XD%ef%bc%8ccode%e5%a6%82%e4%b8%8b%ef%bc%8c%e6%88%91%e4%b8%8d%e7%9f%a5%e9%81%93%e8%a9%b2%e5%b0%8d%e8%a3%b8%e9%a1%8c%e5%81%9a%e7%94%9a%e9%ba%bc%e8%a7%a3%e9%87%8b%0a%e5%af%ab%e5%89%aa%e5%88%87%e5%8d%80%e9%96%93%e7%9a%84splay%e7%9a%84%e6%99%82%e5%80%99%e8%a6%81%e6%b3%a8%e6%84%8f%e7%9a%84%e5%8f%af%e8%83%bd%e5%b0%b1%e6%98%af%e4%b8%8d%e8%a6%81%e6%94%b9%e5%88%b0%e7%a9%ba%e7%af%80%e9%bb%9e%28%e6%88%91%e6%98%af%e7%94%a80%e4%bb%a3%e8%a1%a8%e7%a9%ba%e7%af%80%e9%bb%9e%29%e7%9a%84%e4%bb%bb%e4%bd%95%e5%80%bc%0a%e4%b9%9f%e5%b0%8f%e5%bf%83%e4%b8%8d%e8%a6%81%e8%ae%93%e5%90%88%e4%bd%b5%e7%9a%84%e6%99%82%e5%80%99%e5%90%88%e4%bd%b5%e5%88%b0%e5%90%8c%e4%b8%80%e6%a3%b5splay%ef%bc%8c%e5%87%ba%e7%8f%be%e7%92%b0%0a%e4%b8%ad%e9%80%94%e6%9c%89%e4%b8%80%e6%ac%a1%e4%b8%80%e5%80%8b%e5%9b%9e%e5%82%b3int%e7%9a%84%e5%87%bd%e6%95%b8%e5%bf%98%e8%a8%98%e5%9b%9e%e5%82%b3%e6%9d%b1%e8%a5%bf%ef%bc%8c%e5%9c%a8TIOJ%e4%b8%8a%e5%90%83SF%0aAC%20code%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%2014%2015%2016%2017%2018%2019%2020%2021%2022%2023%2024%2025%2026%2027%2028%2029%2030%2031%2032%2033%2034%2035%2036%2037%2038%2039%2040%2041%2042%2043%2044%2045%2046%2047%2048%2049%2050%2051%2052%2053%2054%2055%2056%2057%2058%2059%2060%2061%2062%2063%2064%2065%2066%2067%2068%2069%2070%2071%2072%2073%2074%2075%2076%2077%2078%2079%2080%2081%2082%2083%2084%2085%2086%2087%2088%2089%2090%2091%2092%2093%2094%2095%2096%2097%2098%2099%20100%20101%20102%20103%20104%20105%20106%20107%20108%20109%20110%20111%20112%20113%20114%20115%20116%20117%20118%20119%20120%20121%20122%20123%20124%20125%20126%20127%20128%20129%20130%20131%20132%20133%20134%20135%20136%20137%20138%20139%20140%20141%20142%20143%20144%20145%20146%20147%20148%20149%20150%20151%20152%20153%20154%20155%20156%20157%20158%20159%20160%20161%20162%20163%20164%20165%20166%20167%20168%20169%20170%20171%20172%20173%20174%20175%20176%20177%20178%20179%20180%20181%20182%20183%20184%20185%20186%20187%20188%20189%20190%20191%20192%20193%20194%20195%20196%20197%20198%20199%20200%20201%20202%20203%20204%20205%20206%20207%20208%20209%20210%20211%20212%20213%20214%20215%20%20%23include%20%26lt%3bcstdio%26gt%3b%23include%20%26lt%3bcstdlib%26gt%3b%20const%20int%20N%20%3d%20200025%3b%20int%20n%2c%20q%2c%20v%5bN%5d%3b%20struct%20SplayTree%20%7b%20struct%20node%20%7b%20int%20val%2c%20sz%3b%20int%20sum%3b%20int%20ch%5b2%5d%2c%20pa%3b%20%2f%2fbool%20rev%3b%20%20%7d%20S%5bN%5d%3b%20bool%20dir%28int%20i%29%20%7breturn%20i%3d%3dS%5bS%5bi%5d." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2020%2f02%2f22%2fTIOJ-2124%2f&t=TIOJ-2124" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick="$('#nav-footer').toggle();return false;" aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc-toggle class=icon href=# onclick="$('#toc-footer').toggle();return false;" aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share-toggle class=icon href=# onclick="$('#share-footer').toggle();return false;" aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 Omelet</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/resources>Resources</a></li><li><a href=/search>Search</a></li><li><a href=/tags>Tags</a></li></ul></nav></div></footer></div><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>$(function(){var btn="<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";btn+='<i class="far fa-clone"></i>';btn+='</span>';$(".highlight table").before(btn);var clip=new ClipboardJS('.btn-copy',{text:function(trigger){var selector='code[data-lang]:not([data-lang=""])';var ret=Array.from(trigger.nextElementSibling.querySelectorAll(selector)).reduce((str,it)=>str+it.innerText+'\n','')
return ret;}});clip.on("success",function(e){e.trigger.setAttribute('aria-label',"Copied!");e.clearSelection();});clip.on("error",function(e){console.error("Action:",e.action);console.error("Trigger:",e.trigger);});});</script><script type=text/javascript src=/js/canvas-nest.js count=90 color=0,200,100 opacity=0.5></script></body></html>